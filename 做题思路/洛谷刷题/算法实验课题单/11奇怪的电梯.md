# P1135 å¥‡æ€ªçš„ç”µæ¢¯

## é¢˜ç›®èƒŒæ™¯

æ„Ÿè°¢ @[yummy](https://www.luogu.com.cn/user/101694) æä¾›çš„ä¸€äº›æ•°æ®ã€‚

## é¢˜ç›®æè¿°

å‘µå‘µï¼Œæœ‰ä¸€å¤©æˆ‘åšäº†ä¸€ä¸ªæ¢¦ï¼Œæ¢¦è§äº†ä¸€ç§å¾ˆå¥‡æ€ªçš„ç”µæ¢¯ã€‚å¤§æ¥¼çš„æ¯ä¸€å±‚æ¥¼éƒ½å¯ä»¥åœç”µæ¢¯ï¼Œè€Œä¸”ç¬¬ $i$ å±‚æ¥¼ï¼ˆ$1 \le i \le N$ï¼‰ä¸Šæœ‰ä¸€ä¸ªæ•°å­— $K_i$ï¼ˆ$0 \le K_i \le N$ï¼‰ã€‚ç”µæ¢¯åªæœ‰å››ä¸ªæŒ‰é’®ï¼šå¼€ï¼Œå…³ï¼Œä¸Šï¼Œä¸‹ã€‚ä¸Šä¸‹çš„å±‚æ•°ç­‰äºå½“å‰æ¥¼å±‚ä¸Šçš„é‚£ä¸ªæ•°å­—ã€‚å½“ç„¶ï¼Œå¦‚æœä¸èƒ½æ»¡è¶³è¦æ±‚ï¼Œç›¸åº”çš„æŒ‰é’®å°±ä¼šå¤±çµã€‚ä¾‹å¦‚ï¼š $3, 3, 1, 2, 5$ ä»£è¡¨äº† $K_i$ï¼ˆ$K_1=3$ï¼Œ$K_2=3$ï¼Œâ€¦â€¦ï¼‰ï¼Œä» $1$ æ¥¼å¼€å§‹ã€‚åœ¨ $1$ æ¥¼ï¼ŒæŒ‰â€œä¸Šâ€å¯ä»¥åˆ° $4$ æ¥¼ï¼ŒæŒ‰â€œä¸‹â€æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œå› ä¸ºæ²¡æœ‰ $-2$ æ¥¼ã€‚é‚£ä¹ˆï¼Œä» $A$ æ¥¼åˆ° $B$ æ¥¼è‡³å°‘è¦æŒ‰å‡ æ¬¡æŒ‰é’®å‘¢ï¼Ÿ

## è¾“å…¥æ ¼å¼

å…±äºŒè¡Œã€‚  

ç¬¬ä¸€è¡Œä¸ºä¸‰ä¸ªç”¨ç©ºæ ¼éš”å¼€çš„æ­£æ•´æ•°ï¼Œè¡¨ç¤º $N, A, B$ï¼ˆ$1 \le N \le 200$ï¼Œ$1 \le A, B \le N$ï¼‰ã€‚

ç¬¬äºŒè¡Œä¸º $N$ ä¸ªç”¨ç©ºæ ¼éš”å¼€çš„éè´Ÿæ•´æ•°ï¼Œè¡¨ç¤º $K_i$ã€‚

## è¾“å‡ºæ ¼å¼

ä¸€è¡Œï¼Œå³æœ€å°‘æŒ‰é”®æ¬¡æ•°ï¼Œè‹¥æ— æ³•åˆ°è¾¾ï¼Œåˆ™è¾“å‡º `-1`ã€‚

## è¾“å…¥è¾“å‡ºæ ·ä¾‹ #1

### è¾“å…¥ #1

```
5 1 5
3 3 1 2 5
```

### è¾“å‡º #1

```
3
```

## è¯´æ˜/æç¤º

å¯¹äº $100 \%$ çš„æ•°æ®ï¼Œ$1 \le N \le 200$ï¼Œ$1 \le A, B \le N$ï¼Œ$0 \le K_i \le N$ã€‚

æœ¬é¢˜å…± $16$ ä¸ªæµ‹è¯•ç‚¹ï¼Œå‰ $15$ ä¸ªæ¯ä¸ªæµ‹è¯•ç‚¹ $6$ åˆ†ï¼Œæœ€åä¸€ä¸ªæµ‹è¯•ç‚¹ $10$ åˆ†ã€‚

![alt text](image-1.png)


***OKå•Šå­©å­ä»¬è¿™ä¸ªé¢˜å¯ä»¥è¯´æ˜¯éå¸¸å…¨é¢äº†ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æ˜¯æ€ä¹ˆä¸€æ­¥æ­¥å­¦åˆ°å¾ˆå¤šä¸œè¥¿çš„***

# ä¸€é“å¤¯çˆ†äº†çš„å›¾è®ºï¼‹æœç´¢é¢˜çš„å­¦ä¹ ç¬”è®°
(æ‰©å±•ï¼Œèƒ½å¦æ‰¾åˆ°æœ€çŸ­è·¯è¾“å‡ºï¼Ÿ)
## é¢˜ç›®åˆå°è¯•


### æš´åŠ›dfs
```
æˆ‘çš„æ€è·¯æ˜¯è¿™æ ·ï¼Œå¯ä»¥ç”¨æ·±åº¦å’Œå¹¿åº¦ä¼˜å…ˆï¼Œè¿™é‡Œå…ˆç”¨æ·±åº¦ï¼Œ
å…ˆæŠŠç»™åˆ°çš„æ¯å±‚æ•°å­—è®°å½•åœ¨æ•°ç»„ä¸­ï¼Œè¿™é‡Œæ•°ç»„æˆ‘ä»¬ä½¿ç”¨1-basedï¼Œç„¶åä½¿ç”¨dfsï¼Œ
è¿™é‡Œå› ä¸ºå¯èƒ½åˆ°ä¸äº†ï¼Œä»¥åŠé˜²æ­¢å¾ªç¯ï¼Œéœ€è¦ç”¨ä¸€ä¸ªvisitedæ•°ç»„è®°å½•æ¯ä¸€å±‚æ˜¯å¦åˆ°è¾¾ï¼Œ


dfså‡½æ•°æˆ‘ä»¬è¿™æ ·å†™ï¼Œæ¥å—ä¸¤ä¸ªå‚æ•°ï¼Œä»å“ªä¸€å±‚åˆ°å“ªä¸€å±‚ï¼Œè¿”å›æ‰€éœ€çš„æœ€å°‘æ¬¡æ•°ï¼Œ
åˆ°è¾¾ä¸äº†åˆ™è¿”å›0x3f3f3f3f,æ–¹ä¾¿ä»¥åçš„æœ€å°å€¼åˆ¤æ–­ï¼Œ

é¦–å…ˆè€ƒè™‘ä¸¤ä¸ªæ–¹å‘ï¼Œè¿”å›dfsæœ€å°å€¼+1ï¼ˆå³min(dfs(cur + k[cur],tar),dfs(cur - k[cur],tar)+1ï¼‰ï¼Œå¡«å…¥å¯¹åº”å‚æ•°ï¼Œè¿™é‡Œvisitedæ•°ç»„ä½œä¸ºå…¨å±€æ•°ç»„ï¼Œ
è¡¨ç¤ºåˆ°ä¸€æ¬¡å°±ä¸ç”¨è€ƒè™‘äº†ï¼Œå¯¹äºä¸€æ¬¡æŸ¥è¯¢è¿™æ˜¯åˆç†çš„ï¼Œï¼ˆå¦å¤–ï¼Œè¿™é‡Œä½ å¯ä»¥å‘Šè¯‰æˆ‘æ€ä¹ˆå¤„ç†å¤šæ¬¡æŸ¥è¯¢?åœ¨æ¯æ¬¡æŸ¥è¯¢åé‡ç½®visitedæ•°ç»„å—ï¼‰ï¼Œ

å¦‚æœcurï¼ˆç¬¬ä¸€ä¸ªå‚æ•°ï¼‰== tarï¼Œå³å¯ä»¥è¿”å›1ï¼Œè¡¨ç¤ºæŒ‰ä¸€æ¬¡å¯ä»¥åˆ°.

æœ€ååœ¨ä¸»å‡½æ•°ä¸­è°ƒç”¨dfs(a,b)å³å¯
```
#### å°æ’æ›²
åœ¨è§£å†³è®°å¿†åŒ–ä¹‹å‰ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹åŸå§‹ä»£ç ä¸­å¯ä»¥å­¦ä¹ çš„åœ°æ–¹
```c++
int dfs(int cur, int tar){
    if (cur == tar) return MAX;
    if (cur <= 0 || cur > n) return MAX;
    if (memo[cur][tar] != MAX) return memo[cur][tar];
    memo[cur][tar] =  min(dfs(cur + k[cur], tar),dfs(cur - k[cur], tar) + 1);
    return memo[cur][tar];
}
```
è¿™ä¸ªæ˜¯åˆå§‹ç‰ˆæœ¬ï¼Œå› ä¸ºæœ€åˆè§‰å¾—memoæ•°ç»„å¯ä»¥ä»£æ›¿visitedï¼Œå°±ç›´æ¥è¿™æ ·å†™äº†ï¼Œæ¥çœ‹çœ‹é—®é¢˜
1.bæ˜¯å…¨å±€å˜é‡ï¼Œå¯ä»¥ç›´æ¥ä¼˜åŒ–ä¸€ä¸ªå‚æ•°
2.memoä¸å¯ä»¥ä»£æ›¿visited,å½“æ—¶çš„ä¸»è§‚æ€è·¯ï¼Œæˆ‘æƒ³ç°åœ¨ä¸ç”¨è§£é‡Šäº†
3.å¦‚æœä¸¤ä¸ªéƒ½ä¸æ»¡è¶³ï¼Œè¿”å›å…¶å®æ˜¯MAX + 1ï¼Œè™½ç„¶åç»­ä¹Ÿå¯ä»¥åˆ¤æ–­ï¼Œä½†æ˜¯MAXè¡¨ç¤ºçš„å…¶å®æ˜¯ä¸å¯è¾¾ï¼ŒMAX + 1åè€Œè¡¨ç¤ºä¸€ä¸ªå¾ˆå¤§å€¼ï¼Œæ‰€ä»¥ä¸ºäº†æ˜ç¡®å«ä¹‰ï¼Œæˆ‘ä»¬æ›´å¥½çš„æ–¹å¼æ˜¯è¿™æ ·å†™
```c++
int up = cur + k[cur];
int down = cur - k[cur];//å˜é‡ä»£æ›¿åæ ‡æ›´æ¸…æ™°
int best = MAX;
int up_ans = (up > n) ? MAX : dfs(up);
int down_ans = (down < 1) ? MAX : dfs(down);
//è¿™é‡Œå¦‚æœç”¨ifåˆ¤æ–­ç„¶åæ¯”è¾ƒçš„è¯ä¼šå¢åŠ dfsè°ƒç”¨ï¼Œæ‰€ä»¥ç”¨å˜é‡up_anså‚¨å­˜èµ·æ¥å†ç”¨åˆ°bestä¸Š
if (up_ans != MAX) best = min(best, up_ans);
if (down_ans != MAX) best = min(best, down_ans);
memo[cur] = best;

```
4.
```c++
cout << (ans >= MAX / 2) ? -1 : ans;
```
ä½ æ•¢æƒ³è¿™ä¸ªæ˜¯é”™çš„å—ï¼Œè¿˜æ˜¯éƒ½åŠ ä¸Šæ‹¬å·ç¨³(<<ä¼˜å…ˆçº§æ›´é«˜)

5.é—®é¢˜æ¥äº†ï¼Œvisitedæ•°ç»„å¯èƒ½ä¼šé˜»æ­¢ä¸åŒè·¯å¾„ï¼Œå°¤å…¶æ˜¯å…ˆèµ°çš„é‚£æ¡è·¯å¾„è¿”å›å€¼æ˜¯max,è¿™æ—¶å€™çœŸæ­£çš„æœ€çŸ­è·¯ä¼šè¢«visitedé˜»å¡ï¼Œï¼ˆè¿™é‡Œå…¶å®å°±èƒ½æ„è¯†åˆ°ç”¨bfsæ›´å¥½äº†ï¼Œæˆ–è€…è¯´çœ‹åˆ°æœ€çŸ­è·¯å°±è¯¥ç”¨bfsï¼‰
æ‰€ä»¥æœ€ç»ˆä¿®æ”¹ç‰ˆæ˜¯è¿™æ ·
ï¼ˆå°è¯•ä¸€ä¸‹ï¼Œæ˜¯å¦èƒ½è‡ªå·±ä¸¾å‡ºåä¾‹ï¼Ÿï¼‰
```c++
int dfs(int cur){
    if (visited[cur] == 1) return MAX;
    if (cur == b) return 0;
    if (memo[cur] != -1) return memo[cur];

    visited[cur] = 1;//æ¡†æ¶

    int up = cur + k[cur];
    int down = cur - k[cur];
    int up_ans = (up <= n) ? dfs(up) : MAX;
    int down_ans = (down > 0) ? dfs(down) : MAX;
    int best = MAX;
    if (up_ans != MAX) best = min(best, up_ans + 1);
    if (down_ans != MAX) best = min(best, down_ans + 1);
    memo[cur] =  best;

    visited[cur] = 0;//å›æº¯

    return memo[cur];
}
```
![alt text](image-3.png)

è¿™é‡ŒåŸºæœ¬æ€è·¯å…¶å®æ˜¯å¯¹çš„ï¼Œä½†æ˜¯ä¸memoè´´ä¸Šå»ä¼štleï¼Œé‚ªæ¶çš„AIæç¤ºæˆ‘ä»¬ç”¨memoæ•°ç»„æ¥è®°å¿†åŒ–ï¼Œæ¥çœ‹çœ‹é—®é¢˜åœ¨å“ª

å¯¹ç…§ä¸Šé¢çš„ä»£ç ï¼Œä¸å¦¨ä¸¾å‡ ä¸ªä¾‹å­ï¼Œå…¶å®å¾ˆéš¾ä¸¾ï¼Œåœ¨å›½äº§å„ä¸ªAIå…¨ä¸¾ä¸å‡ºæ¥ä»¥åŠgptåœ¨æ ·ä¾‹å¸®åŠ©ä¸‹æ‰ä¸¾å‡ºæ¥ï¼Œå…¶å®æ˜¯è¿™æ ·çš„

a = 4,b = 1,è¿™é‡Œçš„3ç”±äºç¬¬ä¸€ä¸ªåœˆ4-5-6-2-3è¢«æ ‡è®°ä¸ºMAXäº†
![alt text](22e4bfc80df671b8c7dd836ae91a0047.jpg)

é—®é¢˜ä¸æ˜¯memoæ•°ç»„æˆ–è€…visitedæ•°ç»„ï¼Œè€Œæ˜¯äºŒè€…çš„è”åˆä½œç”¨ï¼Œåœ¨visitedçš„ç‰¹å®šæƒ…å†µä¸‹ï¼Œmemoæ•°ç»„ä¼šé”™è¯¯çš„æŠŠæŸäº›ä½ç½®è®°é”™ï¼Œå…¶å®è¿™åªæ˜¯è¿™æ¡è·¯å¾„ä¸‹çš„é—®é¢˜ï¼Œè¿™å°±æ¶‰åŠåˆ°ä¸‹é¢è¦è¯´çš„äº†

### dfså‰ªææ¨¡æ‹Ÿbfs
visitedæ•°ç»„çš„ä½œç”¨æ˜¯é˜²æ­¢ç¯ï¼Œä½†å…¶å®æˆ‘ä»¬åº”è¯¥ä¹Ÿå¯ä»¥æƒ³åˆ°é˜²æ­¢ç¯è¿˜æœ‰ä¸€ç§æ–¹å¼ï¼Œå°±æ˜¯é€šè¿‡é•¿åº¦å‰ªæï¼Œå¦‚æœç°åœ¨å¾—åˆ°çš„é•¿åº¦æ¯”ä¹‹å‰å‚¨å­˜çš„é•¿åº¦è¿˜è¦é•¿ï¼Œé‚£å°±æ²¡æœ‰æ›´æ–°çš„å¿…è¦äº†ã€‚
ä»£ç å¦‚ä¸‹ï¼š
```c++
if (up <= n && dist[cur] + 1 < dist[up]) {
    ...//dist[x]è¡¨ç¤ºå½“å‰xåˆ°açš„æœ€çŸ­è·ç¦»
}
```
ç”¨distæ•°ç»„çš„åˆ¤æ–­æ¥ä»£æ›¿visitedæ•°ç»„é¿å…ç¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥å¾—åˆ°ä¸€ç‰ˆæ–°çš„ä»£ç 
```c++
int dfs(int cur){//dfs[cur]è¡¨ç¤ºcurèŠ‚ç‚¹åˆ°bçš„æœ€çŸ­è·¯å¾„
    if (cur == b) return 0;
    if (k[cur] == 0) return MAX;
    int up = cur + k[cur];
    int down = cur - k[cur];
    int up_ans = MAX, down_ans = MAX;
    if (up <= n && dist[up] > dist[cur] + 1) {
        dist[up] = dist[cur] + 1;//æ³¨æ„æ›´æ–°æ—¶æœº
        up_ans = dfs(up);
    }
    if (down > 0 && dist[down] > dist[cur] + 1) {
        dist[down] = dist[cur] + 1;
        down_ans = dfs(down);
    }
    int best = MAX;
    if (up_ans != MAX) {
        best = min(best, up_ans + 1);
    }
    if (down_ans != MAX ) {
        best = min(best, down_ans + 1);
    }
    return best;
}
```
å…¶å®è¿˜å¯ä»¥æ›´ç®€åŒ–ï¼Œå› ä¸ºdistæ•°ç»„å°±å¯ä»¥ä»£è¡¨aåˆ°ä»»ä½•ç‚¹çš„è·ç¦»äº†ï¼Œæ‰€ä»¥å‡½æ•°å¯ä»¥ä¸éœ€è¦è¿”å›å€¼ï¼Œç›´æ¥è¾“å‡ºdist[b]ï¼ŒåŒæ—¶ï¼Œè¿™æ—¶çš„dfså¯ä»¥ç”¨æ‰‹åŠ¨å‹æ ˆä»£æ›¿äº†

![alt text](image-4.png)
é‚£ä¹ˆæˆ‘ä»¬å¾ˆå®¹æ˜“è”æƒ³åˆ°ï¼Œdistæ•°ç»„å’Œæˆ‘çš„memoæ•°ç»„æœ‰ä»€ä¹ˆåŒºåˆ«å‘¢?æˆ‘ä»¬ç›´æ¥ç”¨memoæ•°ç»„ä¹Ÿä¸è¦visitedæ•°ç»„èƒ½ä¸èƒ½å®ç°å‘¢?
å…³é”®åœ¨dist[a] = 0;è¿™æ ·dist[cur] + 1 < dist[next]æ˜¯å¯ä»¥åˆ¤æ–­çš„äº†ï¼Œæ‰€ä»¥å¦‚æœæ˜¯memoï¼Œæˆ‘ä»¬å°±éœ€è¦åå‘éå†ï¼Œè¿™ä¸ªæ—¶å€™å…¶å®ä¸¤ä¸ªæ•°ç»„å°±æ˜¯ç­‰ä»·çš„äº†ï¼Œmemo[b] = 0,æ¥çœ‹çœ‹gptæ€ä¹ˆè¯´
![alt text](image-5.png)


OKï¼Œç°åœ¨æ˜¯è¿™ä¸€éƒ¨åˆ†çš„æ€»ç»“
|åºå·|ç»†èŠ‚å…³é”®ç‚¹|é‡è¦ç¨‹åº¦|åºå·|æ¨¡ç‰ˆå…³é”®ç‚¹|é‡è¦ç¨‹åº¦|
|---|---|---|---|---|---|
|1|è¾¹ç•Œ(up >= 1è€Œä¸æ˜¯0)|â­â­|11|visitedåœ¨dfsä¸­çš„å›æº¯æ¨¡ç‰ˆ|â­â­|
|2|ç­”æ¡ˆæ˜¯å…¨å±€å˜é‡ï¼Œå¯ä»¥ä¼˜åŒ–å‚æ•°|â­|22|memoå’ŒvisitedåŒæ—¶å­˜åœ¨æ—¶<br>ç”±äºçŠ¶æ€ä¾èµ–å¯¼è‡´çš„é”™è¯¯|â­â­|
|3|coutå’Œ?çš„ä¼˜å…ˆçº§|â­|33|dfsé€šè¿‡distå‰ªææ¨¡æ‹Ÿbfs|â­|
|4|distçš„æ›´æ–°æ—¶æœº|â­|44|MAXè¿”å›å€¼çš„ä¼˜åŒ–å†™æ³•|â­â­|


![alt text](image-6.png)
![alt text](image-7.png)
ï¼ˆæˆ‘æ˜¯æ¥åˆ†å‰²çš„ï¼‰


## æ­£ç¡®æƒ³æ³•ï¼šBFS
ä»£ç æ˜¯å¥½å†™çš„ï¼Œæ³¨æ„ä¸€å®šè¦visited,å…³é”®ï¼š
```c++
visited[a] = 1;
```
è¿™å¾ˆé‡è¦
è¿˜æœ‰å°±æ˜¯ï¼Œvisitedçš„æ ‡è®°æ—¶æœº
```c++
    int cur = q.front();
    if (cur == b) {
        flg = 1;
        break;
    }
    q.pop();
    visited[cur] = 1;
    int up = cur + k[cur];
    int down = cur - k[cur];
    if (up <= n && !visited[up]) q.push(up);
    if (down >= 1 && !visited[down]) q.push(down);
```
è¿™æ ·ä¼šå¯¼è‡´å¾ˆå¤šé‡å¤ï¼Œå…¥é˜Ÿæ—¶å°±åº”è¯¥æ ‡è®°
```c++
if (){
    visited[up] = 1;
    q.push(up);
}
```
åŒæ—¶ï¼Œæ‰¾åˆ°äº†æœ€å¥½ç›´æ¥è¿”å›ï¼Œä¸ç„¶breakååœ¨ä¸‹é¢ans--è¿™æ ·ä¿®æ­£å¯èƒ½éº»çƒ¦
```c++
if (cur == b) {
    cout << ans;//ansåœ¨å¤–å±‚å¾ªç¯ä¸­ï¼Œæ¯å±‚é€’å¢
    return 0;
}
```
æœ€åï¼Œè¿™é‡Œä¸€ç›´é”™ï¼Œå› ä¸ºæ²¡æœ‰ç”¨MAX,æ‰€ä»¥æ²¡åœ¨æ„è¿”å›å€¼ï¼Œæ³¨æ„æ— è§£æ—¶è¿”å›-1

æ€»ç»“ä¸€ä¸‹bfsçš„ç‚¹
|åºå·|å…³é”®ç‚¹|é‡è¦æ€§|
|---|---|---|
|1|visitedæ•°ç»„çš„åˆå§‹ç‚¹|â­â­â­|
|2|wisitedçš„æ ‡è®°æ—¶æœºï¼ˆå…¥é˜Ÿï¼‰|â­â­|
|3|å¾—åˆ°ç­”æ¡ˆå’Œæ— è§£çš„å¤„ç†|â­|

![alt text](image-8.png)
![alt text](image-9.png)
## å…¶ä»–é€šè¿‡è¿™é“é¢˜å¤ä¹ çš„ä¹±ä¸ƒå…«ç³Ÿçš„åšæ³•
é¦–å…ˆï¼ŒæŠŠè¿™é“é¢˜å»ºæ¨¡æˆç­‰æƒæœ‰å‘å›¾çš„å•æºæœ€çŸ­è·¯å°±æ˜¯ä¸ªæœ¬äº‹
### dijkstra

é¦–å…ˆå¤ä¹ ä¸€ä¸‹ä»€ä¹ˆæ˜¯dijkstra

æ¯æ¬¡æ‰¾åˆ°   ***æœªè®¿é—®è¿‡çš„***   ***æœ€è¿‘ç‚¹***
é€šè¿‡å®ƒæ¥æ¾å¼›å…¶ä»–è¾¹

æ˜¾ç„¶ï¼Œæˆ‘ä»¬éœ€è¦ç”¨é˜Ÿåˆ—æ¥å‚¨å­˜è®¿é—®è¿‡çš„é‚»å±…ï¼ˆä¸ç„¶ä½ ä¸ä¼šæƒ³æ¯æ¬¡éƒ½éå†å§ï¼‰
è€Œä¸”ï¼Œæˆ‘ä»¬è¦ç”¨çš„æ˜¯æœ€çŸ­çš„ï¼Œæ‰€ä»¥è‡ªç„¶æƒ³åˆ°å°é¡¶å †
è™½ç„¶æ²¡å•¥ç”¨ä½†æ˜¯è¿˜æ˜¯è¯´ä¸€ä¸‹æ—¶é—´å¤æ‚åº¦æ˜¯o((m + n)logn),mæ˜¯è¾¹ï¼Œnæ˜¯ç‚¹ï¼Œå¯¹åº”pushå’Œpopï¼Œè¿™ä¸¤ä¸ªæ“ä½œéƒ½éœ€è¦å †ç”¨lognæ¥è°ƒæ•´

éœ€è¦æ³¨æ„çš„ç‚¹ï¼š
å°é¡¶å †å†™æ³•æ˜¯ï¼š
```c++
priority_queue<pair<int,int>,vector<pair<int,int>>,greater<pair<int,int>>q;
```

å› ä¸ºç¬¬ä¸€ä¸ªæ˜¯æ¯”è¾ƒå¯¹è±¡ï¼Œæ‰€ä»¥è¦å˜æˆ{step,cur}ï¼Œä¸è¦å†™å

åŒæ—¶ï¼Œæ³¨æ„è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªç‚¹ï¼Œå°±æ˜¯
```c++
if (step > dist[cur]) continue;
```
åœ¨æ›´æ–°è¿‡ç¨‹ä¸­ï¼ŒåŸå…ˆè¿›é˜Ÿçš„ç‚¹å¯èƒ½å·²ç»ä¸å¤Ÿä¼˜äº†

æœ€åå†™ä¸€ä¸‹æ¨¡ç‰ˆ
```c++
q.push({0,a});
while (!q.empty()) {
    auto [step, cur] = q.top();
    q.pop();
    if (cur == b) {
        Â·Â·Â·
    }
    if (step > dist[cur]) continue;

    int upÂ·Â·Â·
    if (up <= n && dist[cur] + 1 < dist[up]) {
        dist[up] = dist[cut] + 1;
        q.push({dist[up],up});
    }
}
```

æ€»ç»“ä¸€ä¸‹
|åºå·|å…³é”®ç‚¹|é‡è¦ç¨‹åº¦|
|---|---|---|
|1|å°é¡¶å †å†™æ³•|â­â­|
|2|æ’åºå¯¹äºŒå…ƒç»„çš„è¦æ±‚|â­â­|
|3|dijkstraæ›´æ–°æ—¶çš„å‰ªæ|â­|
|4|dijkstraæ¨¡ç‰ˆ|â­â­|

### åŒå‘bfs
æ€è€ƒï¼š
q1:
```
æ™®é€š BFS ä» èµ·ç‚¹ å•å‘æ‰©å±•ï¼Œå¤§æ¦‚è¦æ¢ç´¢å¤šå°‘ä¸ªèŠ‚ç‚¹ï¼ˆç”¨ k å’Œ d è¡¨ç¤ºï¼‰ï¼Ÿ
```
ans1:
```
æˆ‘ä»¬åªéœ€è¦æœç´¢ä¸€ä¸ªç»ˆç‚¹ï¼Œæ‰€ä»¥å¯ä»¥ä¸¤è¾¹åŒæ—¶æœç´¢æ¥å‡å°èŒƒå›´ï¼Œå› ä¸º
k^d + k^d è¿œå°äº k^(2d)
```

q2:
```
å½“ä¸¤ä¸ª BFS çš„â€œæœç´¢è¾¹ç•Œâ€ç›¸é‡æ—¶ï¼Œæ˜¯å¦æ„å‘³ç€æ‰¾åˆ°äº†æœ€çŸ­è·¯ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ
```
ans2:
```
æ˜¯çš„ï¼Œå› ä¸ºå·¦è¾¹æœ€çŸ­ï¼Œå³è¾¹ä¹Ÿæœ€çŸ­
```

q3:
```
åœ¨åŒå‘ BFS ä¸­ï¼Œæˆ‘ä»¬ä¸ºä»€ä¹ˆè¦ æ¯æ¬¡æ‰©å±•è¾ƒå°çš„é˜Ÿåˆ—ï¼Ÿ
å¦‚æœæˆ‘ä»¬ä¸ç”¨ â€œå°é˜Ÿåˆ—ä¼˜å…ˆâ€ï¼Œä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ
```

ans3:
```
å¯ä»¥å¹³å‡ä¸¤è¾¹çš„æ‹“å±•æ¬¡æ•°ï¼Œå¦‚æœä¸ä¼˜å…ˆå°é˜Ÿåˆ—ï¼Œå¯èƒ½é€€åŒ–æˆå•å‘bfs
```

q4:
```
åˆ¤æ–­ä¸­æ­¢æ˜¯å·¦è¾¹ç­‰äºå³è¾¹ï¼ˆä½†æ˜¯è¿™é‡Œæ€ä¹ˆå†™å‘¢ï¼Œå•å‘bfsé‡Œæ˜¯cur = target,åªéœ€è¦ç»´æŠ¤ä¸€ä¸ªcur,åŒå‘éš¾é“è¦cur1 = cur2å—ï¼Œé‚£å²‚ä¸æ˜¯è¦åµŒå¥—ä¸¤å±‚å¾ªç¯ï¼Œå·¦è¾¹ä¸€å±‚ä¸­çš„æ¯ä¸€ä¸ªåŒ¹é…å³è¾¹çš„ä¸€å±‚ï¼‰
```

ans4:
```
å½“å·¦è¾¹æ‰©æ•£æ—¶ï¼Œåªè¦å®ƒé‡åˆ°ä¸€ä¸ªâ€œå³è¾¹å·²ç»è®¿é—®è¿‡çš„èŠ‚ç‚¹â€ï¼Œå°±è¯´æ˜è·¯å¾„ç›¸é‡äº†

æƒ³è±¡ä¸¤ä¸ªäººä» A å’Œ B åŒæ—¶å¾€ä¸­é—´èµ°ã€‚
ä¸æ˜¯ç­‰èµ°åˆ°åŒä¸€ä¸ªç‚¹æ‰ç®—ç›¸é‡ï¼Œè€Œæ˜¯ï¼š
åªè¦å·¦è¾¹èµ°åˆ°ä¸€ä¸ªç‚¹ï¼Œè¿™ä¸ªç‚¹å·²ç»è¢«å³è¾¹èµ°è¿‡äº†ï¼Œå°±å·²ç»â€œé‡åˆ°â€äº†ï¼
```

q5:
```
æˆ‘è®°å¾—ä¹‹å‰è¿™ä¸ªä¸ç”¨æŒ‰å±‚(æœ€å¤§é£Ÿç‰©é“¾)
```

ans5:
| ç®—æ³•                | å¿…é¡»æŒ‰å±‚æ‰©å±•å—ï¼Ÿ | åŸå›                |
| ----------------- | -------- | ---------------- |
| **æ™®é€š BFSï¼ˆæ— æƒæœ€çŸ­è·¯ï¼‰** | **å¿…é¡»**   | ä¿è¯æœ€çŸ­è·¯            |
| **åŒå‘ BFS**        | **å¿…é¡»**   | æ§åˆ¶æ‰©å±•èŒƒå›´ã€ä¿æŒæœ€çŸ­è·¯ä¸¤è¾¹åŒæ­¥ |
| **æ‹“æ‰‘æ’åºï¼ˆDAG BFSï¼‰** | **ä¸éœ€è¦**  | åªè¦å‰é©±å…ˆå¤„ç†ï¼Œä¸éœ€è¦æœ€çŸ­è·¯   |

![alt text](image.png)
| æ¡ä»¶                 | æ˜¯å¦å¿…é¡»   | è¯´æ˜        |
| ------------------ | ------ | --------- |
| **æ— æƒå›¾æˆ–ç­‰æƒå›¾**        | âœ” å¿…é¡»   | BFS æ‰æ˜¯æœ€çŸ­è·¯ |
| **å›¾å¯é€†ï¼ˆè‡³å°‘ç»ˆç‚¹èƒ½é€†å‘æ‰©å±•ï¼‰** | âœ” å‡ ä¹å¿…é¡» | æ— å‘å›¾æœ€é€‚åˆ    |
| **æœ‰å•ä¸€èµ·ç‚¹ + å•ä¸€ç»ˆç‚¹**   | âœ” å¿…é¡»   | æ‰èƒ½åŒå‘é€¼è¿‘    |
| **æœç´¢ç©ºé—´å¤§ä¸”æ·±**        | æ¨è     | æ‰èƒ½ä½“ç°ä¼˜åŠ¿    |


ä¸‹é¢ç»™å‡ºæ¨¡ç‰ˆä»£ç 
```c++
#include<bits/stdc++.h>
using namespace std;
int bidirection_bfs(int start, int target, vector<vector<int>> &adj){
    if (start == target) return 0;
    int n = adj.size();
    queue<int> qa, qb;
    vector<int> da(n, -1);
    vector<int> db(n, -1);
    da[start] = 0;
    db[target] = 0;
    qa.push(start);
    qb.push(target);
    while (!qa.empty() && !qb.empty()) {
        if (qa.size() <= qb.size()) {
            //æ‰©å±•å·¦è¾¹
            int size = qa.size();
            while (size--) {
                int cur = qa.front();
                qa.pop();
                for (int next : adj[cur]) {
                    if (da[next] == -1) {
                        da[next] = da[cur] + 1;
                        qa.push(next);
                        if (db[next] != -1) {
                            return db[next] + da[next];
                        }
                    }
                }
            }

        }
        else{
            //æ‰©å±•å³è¾¹
            int size = qb.size();

            while (size--) {
                int cur = qb.front();
                qb.pop();
                for (int next : adj[cur]) {
                    if (db[next] == -1) {
                        db[next] = db[cur] + 1;
                        qb.push(next);
                        if (da[next] != -1) {
                            return db[next] + da[next];
                        }
                    }
                }
            }
        }
    }
    return -1;
}
```

å…³é”®é€»è¾‘
```c++
if (qa.size() <= qb.size()) {
    int size = qa.size();
    while (size--) {
        int cur = qa.front();
        qa.pop();
        for (int next: adj[cur]) {
            if (da[next] == -1) {
                da[next] = da[cur] + 1;
                qa.push(next);
                if (db[next] != -1) {
                    return da[next] + db[next];
                }
            }
        }
    }
}
```

### bellman-ford
ğŸ§© 1. æˆ‘ä»¬å…ˆä»ä¸€ä¸ªæœ€ç®€å•çš„é—®é¢˜å¼€å§‹ï¼š

å¦‚æœå›¾ä¸­æ²¡æœ‰è´Ÿæƒè¾¹ï¼Œæ€ä¹ˆæ±‚å•æºæœ€çŸ­è·¯å¾„ï¼Ÿ

ä½ ä¼šæƒ³åˆ°ï¼š

BFSï¼ˆåªé€‚ç”¨äºç­‰æƒå›¾ï¼‰

Dijkstraï¼ˆé€‚ç”¨äºæ­£æƒå›¾ï¼‰

ä½†ä¸ºä»€ä¹ˆ Dijkstra ä¸èƒ½å¤„ç†è´Ÿæƒï¼Ÿ

å› ä¸º Dijkstra çš„å…³é”®é€»è¾‘æ˜¯ï¼š

å½“ä½ æŠŠæœ€å° dist çš„èŠ‚ç‚¹å¼¹å‡ºæ—¶ï¼Œè¿™ä¸ª dist æ˜¯æœ€ç»ˆå€¼ã€‚

ä½†å¦‚æœæœ‰è´Ÿæƒï¼Œä½ å¼¹å‡ºæ¥åå¯èƒ½è¢«å…¶ä»–è·¯å¾„ç»§ç»­å˜å° â†’ ç ´åæ­£ç¡®æ€§ã€‚

æ‰€ä»¥ï¼š
ğŸ‘‰ æˆ‘ä»¬éœ€è¦ä¸€ä¸ªèƒ½å¤„ç†è´Ÿæƒçš„ç®—æ³•ã€‚

2.ç®—æ³•ç†è§£ï¼š
ç®—æ³•ç¬¬kè½®å¾—åˆ°çš„æ˜¯kæ¡è¾¹åˆ°åŸç‚¹çš„å‡†ç¡®æœ€çŸ­è·¯å¾„ï¼Œä¸æ˜¯å±‚åºï¼Œåˆ«çš„ä¹Ÿå¯èƒ½è¢«æ›´æ–°ï¼Œä½†ä¸ä¸€å®šæ˜¯æœ€çŸ­çš„ï¼Œv-1è½®å¯ä»¥ä¿è¯æ‰€æœ‰è·¯å¾„éƒ½æ˜¯æœ€çŸ­çš„

ç›´æ¥ä¸Šä»£ç 
```c++
#include<bits/stdc++.h>
using namespace std;
struct Edge{
    int u, v, w;
};
vector<Edge>edges;
int bellman_ford(int start, int target) {
    int n, m;
    cin >> n >> m; 
    const int MAX = 0x3f3f3f3f;
    vector<int>dist(n + 1, MAX);
    dist[start] = 0;
    edges.resize(m);
    for (int i = 0; i < m; i++) {
        cin >> edges[i].u >> edges[i].v >> edges[i].w;
    }
    for (int i = 1; i <= n - 1; i++) {
        for (auto &e: edges) {
            if (dist[e.u] != MAX) dist[e.v] = min(dist[e.v], dist[e.u] + e.w);
        }
    }
    return dist[target];
}
```

```c++
å¯ä»¥ä¼˜åŒ–ï¼š
bool updated = false;
for (int i = 1; i <= n - 1; i++) {
    updated = false;
    for (auto &e : edges) {
        if (dist[e.u] != MAX && dist[e.u] + e.w < dist[e.v]) {
            dist[e.v] = dist[e.u] + e.w;
            updated = true;  // æœ¬è½®æœ‰æ›´æ–°
        }
    }
    if (!updated) break;  // æ— æ›´æ–°ï¼Œå¯æå‰ç»“æŸ
}

```

ç„¶åæ˜¯åˆ¤æ–­è´Ÿç¯
```c++
// æ£€æµ‹è´Ÿç¯
for (auto &e : edges) {
    if (dist[e.u] != MAX && dist[e.u] + e.w < dist[e.v]) {
        cout << "Negative Cycle Detected\n";
        return -1;
    }
}

```

åŠ å…¥å‰é©±è¿”å›è·¯å¾„
```c++
vector<int> restore_path(int start, int target, vector<int> &pre, vector<int> &dist) {
    const int INF = 0x3f3f3f3f;
    vector<int> path;

    if (dist[target] == INF) return path;  // æ— è·¯å¾„ï¼Œè¿”å›ç©º

    int cur = target;
    while (cur != -1) {
        path.push_back(cur);
        if (cur == start) break;   // åˆ°è¾¾èµ·ç‚¹
        cur = pre[cur];
    }

    reverse(path.begin(), path.end());
    return path;
}

```
|åºå·|å…³é”®ç‚¹|é‡è¦ç¨‹åº¦|
|---|---|---|
|1|åˆå§‹å€¼startçš„åˆå§‹åŒ–|â­â­|
|2|æ³¨æ„æ¾å¼›é¡ºåº|â­|
|3|i < n - 1æ˜¯ç‚¹nè€Œä¸æ˜¯è¾¹m|â­|
|4|ç¡®ä¿å¯è¾¾|â­|
|5|ä¼˜åŒ–|â­|
|6|whileä¸­ä¿ç•™startä¸€å—çš„å­¦ä¹ |â­|
|7|å‰é©±æ¥è·å¾—è·¯å¾„|â­â­|

### SPFA
åœ¨æ¾å¼›çš„æ—¶å€™å…¶å®åªæœ‰ä¸€ä¸ªç‚¹æ¾å¼›åå¯¹åº”åé¢çš„è¾¹æ‰ä¼šè¢«æ¾å¼›ï¼Œåˆšæ‰çš„ä¼˜åŒ–ä¸­æˆ‘ä»¬å¯¹ä¸€è½®è¿›è¡Œäº†ä¼˜åŒ–ï¼Œç°åœ¨å¯ä»¥æ›´åŠ ç»†è‡´ï¼Œä»…ä»…æ›´æ–°æ”¹å˜çš„èŠ‚ç‚¹ï¼Œå½“ç„¶ï¼Œè¿™äº›ç”¨é˜Ÿåˆ—å‚¨å­˜

è¿™é‡Œçš„å…³é”®ç‚¹åœ¨äºï¼š
1.in_queue[]æ•°ç»„è®°å½•æ˜¯å¦åœ¨é˜Ÿåˆ—é‡Œï¼Œå¦‚æœåœ¨ï¼Œå°±ä¸ç”¨é‡å¤è¿›é˜Ÿ
2.cnt[]æ•°ç»„è®°å½•è¿›é˜Ÿæ¬¡æ•°ï¼Œå¦‚æœæ¬¡æ•°è¶…è¿‡nï¼Œé‚£å°±è¯´æ˜æœ‰è´Ÿç¯

å‰é¢çš„å¤„ç†ï¼š

```c++
dist[start] = 0;
q.push(start);
cnt[start] = 1;
in_queue[start] = 1;
```

ä¸»ä½“éƒ¨åˆ†ï¼š

```c++
while (!q.empty()) {
    int u = q.front();q.pop();
    in_queue[u] = 0;

    for (auto[v, w]: adj[u]) {
        if (dist[u] + w < dist[v]) {
            dist[v] = dist[u] + w;
            pre[v] = u;
            if (in_queue[v] == 0){
                q.push(v);
                in_queue[v] = 1;
                cnt[v]++;
                if(cnt[v] > n){
                    cout << "Negative Cycle Detected\n";
                    return -1;
                }   
            }
        }
    }
}
```
æ³¨æ„æ›´æ–°å’Œä¿ç•™å‰é©±æ˜¯åœ¨åˆ¤æ–­æ˜¯å¦å…¥é˜Ÿå‰çš„

ä¸‹é¢æ˜¯è·¯å¾„æ¢å¤çš„ä»£ç ï¼š

```c++
vector<int>path;
if (dist[target] == MAX) {
    cout << "no path";
    return 0;
}
int cur = target;
while (cur != -1) {
    path.push_back(cur);
    cur = pre[cur];
}
reverse(path.begin(), path.end());
```

### floyd
```c++
#include <bits/stdc++.h>
using namespace std;

const int INF = 0x3f3f3f3f;

vector<vector<int>> dist;
vector<vector<int>> path;

void getPath(int i, int j, vector<int> &res) {
    if (path[i][j] == -1) {
        res.push_back(j);
        return;
    }
    int k = path[i][j];
    getPath(i, k, res);
    getPath(k, j, res);
}

int main() {
    int n, m;
    cin >> n >> m;

    dist.assign(n+1, vector<int>(n+1, INF));
    path.assign(n+1, vector<int>(n+1, -1));

    for (int i = 1; i <= n; i++) dist[i][i] = 0;

    for (int i = 0; i < m; i++) {
        int u, v, w;
        cin >> u >> v >> w;
        dist[u][v] = min(dist[u][v], w);
    }

    for (int k = 1; k <= n; k++) {
        for (int i = 1; i <= n; i++) {
            for (int j = 1; j <= n; j++) {

                if (dist[i][k] < INF && dist[k][j] < INF &&
                    dist[i][k] + dist[k][j] < dist[i][j]) {

                    dist[i][j] = dist[i][k] + dist[k][j];
                    path[i][j] = k; // è®°å½•ç¬¬ä¸€æ¬¡æ‹†åˆ†ç‚¹
                }
            }
        }
    }

    // åˆ¤æ–­è´Ÿç¯
    for (int i = 1; i <= n; i++) {
        if (dist[i][i] < 0) {
            cout << "Negative Cycle Detected\n";
            return 0;
        }
    }

    // ç¤ºä¾‹è¾“å‡ºï¼š1 åˆ° n çš„è·¯å¾„
    int s = 1, t = n;
    if (dist[s][t] >= INF) {
        cout << "NO PATH\n";
    } else {
        cout << "distance = " << dist[s][t] <<"\n";
        vector<int> res;
        res.push_back(s); // èµ·ç‚¹æ‰‹åŠ¨åŠ 
        getPath(s, t, res);

        for (int x : res) cout << x << " ";
        cout << "\n";
    }

    return 0;
}

```